<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>index.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="TasksJz.html">TasksJz</a><ul class='methods'><li data-type='method'><a href="TasksJz.html#_existsTask">_existsTask</a></li><li data-type='method'><a href="TasksJz.html#_updateDB">_updateDB</a></li><li data-type='method'><a href="TasksJz.html#add">add</a></li><li data-type='method'><a href="TasksJz.html#edit">edit</a></li><li data-type='method'><a href="TasksJz.html#getAllTasks">getAllTasks</a></li><li data-type='method'><a href="TasksJz.html#remove">remove</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">index.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const fs = require('fs');
const cmd = require('child_process');

/**
 * Allows adding, removing and editing tasks from a JSON file.
*/
const TasksJz = class {

	/**
	 * Save the parsed JSON file data to "this._db".
	 * @param {String} dbPath - Path of the JSON file that will have the tasks.
	*/
	constructor (dbPath) {

		this._dbPath = dbPath;
		this._db = JSON.parse(fs.readFileSync(this._dbPath, 'utf-8'));

	}

	/**
	 * Return all tasks. (db)
	 * @returns {Array&lt;String>} 
	*/
	getAllTasks () {

		return this._db;

	}
 
	/**
	 * Checks if a task exists or not, returns "true" if it exists and "false" otherwise.
	 * @param {String} task - Is the task that will be checked if it exists.
	 * @returns {Boolean}
	*/
	_existsTask (task) {

		return this._db.map(taskObj => taskObj.task).includes(task);

	}

	/**
	 * Update the JSON file. (db)
	*/
	_updateDB () {

		fs.writeFileSync(this._dbPath, JSON.stringify(this._db, null, 2));

	}

	/**
	 * Add a new task if it doesn't exist.
	 * @param {String} task - It's the task to add.
	*/
	add (task) {

		if (!this._existsTask(task)) {

			this._id = this._db.length + 1;

			this._db.push({
				id: this._id,
				task: task
			});

			this._updateDB();

		}

	}

	/**
	 * Remove a task if it exists.
	 * @param {Number} id - Is the number of the task to remove.
	*/
	remove (id) {

		if (this._db[id - 1]) {

			this._db.splice(id - 1, 1);
			this._db.forEach( (taskObj, index) => taskObj.id = index + 1);
			
			this._updateDB();

		}

	}

	/**
	 * Edit a task if it exists.
	 * @param {Number} id - Is the number of the task to edit.
	*/
	edit (id) {

		if (this._db[id - 1]) {

			const taskTemporaryPath = 'task-temp.txt';

			fs.writeFileSync(taskTemporaryPath, this._db[id - 1].task);

			cmd.spawnSync('nvim', [taskTemporaryPath], {
				stdio: 'inherit',
				dateched: true
			});

			const updatedTask = fs.readFileSync(taskTemporaryPath, 'utf-8').trim();

			this._db[id - 1].task = updatedTask;

			this._updateDB();

			fs.rmSync(taskTemporaryPath);

		}

	}

}

module.exports = TasksJz;
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.10</a> on Fri Jun 10 2022 17:01:35 GMT-0400 (Venezuela Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
